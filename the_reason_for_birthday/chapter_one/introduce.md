# 介绍

## OLTP（联机事务处理系统）

## BI (商业智能系统)

* 站在企业视角，通过分析并辅助决策
* Saas技术的普惠
* 现代的BI系统，不需要开发人员的深度介入，只需要用户简单拖拽，搜索就能得到想要的结果

## OLAP（联机分析系统）

### 背景

* BI中最重要的是：olap
* 为了解决大数据量情况下分析查询的性能问题

### 概述

* OLAP；名叫联机分析，也叫多维分析
* 它是通过不同维度进行审视数据，进行深层次分析

### 分类

#### ROLAP

* 关系型-联机分析系统
* 通常用星型模型，或者雪花模型
* 

##### 优缺点

* 这种架构对于数据实时处理能力要求很高

#### MOLAP

* 多维性-联机分析系统
* 使用多维数组的形式保存数据，通过预先聚合结果，空间换时间的能力获取高性能的查询性能
* 常用的有，依托立方体模型

##### 优缺点

* 维度组合爆炸
* 数据实时性
* 更新问题
* 立方体只保留了聚合数据，没办法查询明细数据

#### HOLAP

* 混合模型，（上面两种的混合）

## Clickhouse

### 新思路

* 放弃ROLAP和MOLAP，另辟蹊径，使用搜索引擎来实现OLAP查询----ElasticSearch是此类技术代表
* ES支持实时更新，在百万级别数据的场景下可以做到实时聚合查询，但是数据量继续增大的话，也会有瓶颈

### clickhouse特点

* 具有ROLAP，在线实时查询，完整的DBMS，列式存储，不需要任何预处理，支持批量更新，完善的SQL支持和函数，支持高可用，不依赖Hadoop

### clickhouse发展经历

#### 流量分析产品

* 继承至---Mysql
* 关系模型
* 索引结构----B+树
* 实时查询

#### 自研系统-Metrage

* 键值对模型
* 索引结构----LSM树，（Hbase也是LSM树的索引结构）
* 预先处理
* * 先需要处理的数据预先聚合
  * 对分析的具体场景，进行立方体建模，框定维度和度量，将结果以key-value的形式存储
* 只支持固定报表的功能

#### OLAPServer

* 自定义报表的功能
* 换回去了关系型模型
* 存储结构上
* * 索引文件，，，没有完全使用LSM索引，而是只采用了稀疏索引
  * 数据文件，，，沿用了LSM中数据段的思想，即数据段内数据有序，借助稀疏索引定位数据段
* 引进了列式存储的思想，将索引文件和数据文件按照列字段的粒度进行了拆分
* * 每个列字段，各自独立存储，以此进一步减少数据读取的范围
* 只能算是一个数据库，没有DBMS应有的功能，比如DDL查询

#### Clickhouse

##### 预先聚合还是实时聚合呢？

###### 预先聚合

* 预先聚合可以为查询性能带来质的提升
* 但是
* * 只能使用在固定场景
  * 维度组合爆炸，会导致数据膨胀
  * 数据实时接收，预先聚合，要考虑及时更新数据

###### 实时聚合

* 实时聚合意味着一切都是动态的，数据量庞大的时候，怎么做到更快的返回结果呢

###### 选择---实时聚合

## 性能强的原因

* 按照顺序存储的数据，拥有更高的查询性能。
* * 因为读取顺序文件。会使用更少的磁盘寻道，和寻转延迟时间
* 借助LSM索引结构，软硬件得到了以下优化
* * 磁盘顺序读取
  * 预读缓存
  * 稀疏索引
* 引进了列式存储的概念，每个列字段，各自独立存储，以此进一步减少数据读取的范围
